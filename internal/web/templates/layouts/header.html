{{define "header_styles"}}
/* === TOP APP BAR (Material 3) === */
.md-top-app-bar {
  position: sticky;
  top: 0;
  left: 0;
  right: 0;
  height: var(--md-comp-top-app-bar-height);
  background-color: var(--md-surface-container);
  border-bottom: 1px solid var(--md-outline-variant);
  display: flex;
  align-items: center;
  padding: 0 var(--md-spacing-4);
  z-index: 100;
  transition: box-shadow 280ms;
}

.md-top-app-bar-leading {
  display: flex;
  align-items: center;
  gap: var(--md-spacing-3);
  margin-right: var(--md-spacing-4);
}

.md-top-app-bar-title {
  font-size: var(--md-typescale-title-large);
  font-weight: var(--md-weight-medium);
  color: var(--md-on-surface);
  flex: 1;
}

.md-top-app-bar-actions {
  display: flex;
  align-items: center;
  gap: var(--md-spacing-2);
  margin-left: auto;
}

/* Legacy header support */
.header {
    background-color: var(--md-surface-container);
    border-bottom: 1px solid var(--border);
    padding: var(--spacing-md) var(--spacing-xl);
    display: flex;
    justify-content: center;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 100;
    gap: var(--spacing-xl);
}
.logo {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-primary);
    text-decoration: none;
    position: absolute;
    left: var(--spacing-xl);
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    transition: color var(--transition-fast);
}
.logo:hover {
    color: var(--md-primary);
}
.logo-icon {
    width: 28px;
    height: 28px;
}
.main-nav {
    display: flex;
    gap: var(--spacing-sm);
}
.nav-link {
    padding: var(--spacing-sm) var(--spacing-md);
    color: var(--text-secondary);
    border-radius: var(--radius-sm);
    transition: all var(--transition-fast);
    text-decoration: none;
}
.nav-link:hover {
    color: var(--text-primary);
    background-color: var(--md-surface-container-high);
}
.nav-link.active {
    color: var(--md-on-primary-container);
    background-color: var(--md-primary-container);
}

/* Hide logo text on medium screens to prevent overlap with navigation */
@media (max-width: 1140px) {
    .logo-text {
        display: none;
    }
}

/* Hide header when navigation buttons are removed */
@media (max-width: 768px) {
    .header {
        display: none;
    }
}
{{end}}

{{define "favicon"}}
<link rel="icon" type="image/x-icon" href="/static/images/favicon.ico">
{{end}}

{{define "header"}}
<!-- Offline Toast определен в base.html -->
<header class="header">
    <a href="/gallery" class="logo">
        <img src="/static/images/logo.svg" alt="" class="logo-icon">
        <span class="logo-text">PhotoCore</span>
    </a>
    <nav class="main-nav">
        <a href="/gallery" class="nav-link" data-page="gallery">Галерея</a>
        <a href="/albums" class="nav-link" data-page="albums">Альбомы</a>
        <a href="/favorites" class="nav-link" data-page="favorites">Избранное</a>
        <a href="/upload" class="nav-link" data-page="upload" style="color: var(--md-tertiary);">Загрузка</a>
        <a href="/map" class="nav-link" data-page="map">Карта</a>
        <a href="/search" class="nav-link" data-page="search">Поиск</a>
        <a href="/pwa/settings" class="nav-link" data-page="pwa-settings" style="display: none;">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" style="vertical-align: middle; margin-right: 4px;"><path fill="currentColor" d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
            PWA
        </a>
        {{if .CanEdit}}<a href="/trash" class="nav-link" data-page="trash">Корзина</a>{{end}}
        {{if .IsAdmin}}<a href="/admin" class="nav-link" data-page="admin">Админка</a>{{end}}
    </nav>
</header>

<!-- Bottom Navigation для mobile -->
<nav class="md-navigation-bar">
    <a href="/gallery" class="md-navigation-item" data-page="gallery">
        <div class="md-navigation-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M21 6h-3.17L16 4h-6v2h5.12l1.83 2H21v12H5v-9H3v9c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"/><path d="M8 14c0 2.76 2.24 5 5 5s5-2.24 5-5-2.24-5-5-5-5 2.24-5 5zm5-3c1.65 0 3 1.35 3 3s-1.35 3-3 3-3-1.35-3-3 1.35-3 3-3zM5 6h3V4H4c-.55 0-1 .45-1 1v4h2V6z"/></svg>
        </div>
        <span class="md-navigation-label">Галерея</span>
    </a>
    <a href="/albums" class="md-navigation-item" data-page="albums">
        <div class="md-navigation-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"/></svg>
        </div>
        <span class="md-navigation-label">Альбомы</span>
    </a>
    <a href="/favorites" class="md-navigation-item" data-page="favorites">
        <div class="md-navigation-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
        </div>
        <span class="md-navigation-label">Избранное</span>
    </a>
    <a href="/upload" class="md-navigation-item" data-page="upload">
        <div class="md-navigation-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
        </div>
        <span class="md-navigation-label">Загрузка</span>
    </a>
    <a href="/search" class="md-navigation-item" data-page="search">
        <div class="md-navigation-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
        </div>
        <span class="md-navigation-label">Поиск</span>
    </a>
    <a href="/pwa/settings" class="md-navigation-item" data-page="pwa-settings" style="display: none;">
        <div class="md-navigation-icon">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
        </div>
        <span class="md-navigation-label">PWA</span>
    </a>
</nav>

<script>
(function() {
    var path = window.location.pathname;
    var page = 'gallery';
    if (path.startsWith('/albums') || path.startsWith('/album/')) page = 'albums';
    else if (path.startsWith('/favorites')) page = 'favorites';
    else if (path.startsWith('/upload')) page = 'upload';
    else if (path.startsWith('/map')) page = 'map';
    else if (path.startsWith('/search')) page = 'search';
    else if (path.startsWith('/pwa/settings')) page = 'pwa-settings';
    else if (path.startsWith('/trash')) page = 'trash';
    else if (path.startsWith('/admin')) page = 'admin';

    // Desktop nav
    var link = document.querySelector('.nav-link[data-page="' + page + '"]');
    if (link) link.classList.add('active');

    // Mobile bottom nav
    var navItem = document.querySelector('.md-navigation-item[data-page="' + page + '"]');
    if (navItem) navItem.classList.add('active');

    // Показать вкладку PWA только если приложение установлено как PWA
    var isPWA = window.matchMedia('(display-mode: standalone)').matches ||
                window.navigator.standalone === true ||
                document.referrer.includes('android-app://');

    if (isPWA) {
        var pwaLinks = document.querySelectorAll('[data-page="pwa-settings"]');
        pwaLinks.forEach(function(link) {
            link.style.display = '';
        });
    }

    // Offline Toast управляется через pwa.js
})();
</script>
{{end}}
